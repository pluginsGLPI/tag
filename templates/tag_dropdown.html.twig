{#
 # -------------------------------------------------------------------------
 # Tag plugin for GLPI
 # -------------------------------------------------------------------------
 #
 # LICENSE
 #
 # This file is part of Tag.
 #
 # Tag is free software; you can redistribute it and/or modify
 # it under the terms of the GNU General Public License as published by
 # the Free Software Foundation; either version 2 of the License, or
 # (at your option) any later version.
 #
 # Tag is distributed in the hope that it will be useful,
 # but WITHOUT ANY WARRANTY; without even the implied warranty of
 # MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
 # GNU General Public License for more details.
 #
 # You should have received a copy of the GNU General Public License
 # along with Tag. If not, see <http://www.gnu.org/licenses/>.
 # -------------------------------------------------------------------------
 # @copyright Copyright (C) 2014-2023 by Teclib'.
 # @license   GPLv2 https://www.gnu.org/licenses/gpl-2.0.html
 # @link      https://github.com/pluginsGLPI/tag
 # -------------------------------------------------------------------------
 #}

{% import 'components/form/fields_macros.html.twig' as fields %}

{% set tagDropdownOptions = {
    'in_itilobject': {
        'full_width': true,
        'field_class': 'col-12 col-sm-12',
        'label_class': 'col-2 col-sm-2',
        'input_class': 'col-10 col-sm-10',
        'is_horizontal': true,
        'align_label_right': true,
        'mb': 'mb-2'
    },
    'is_form': {
        'full_width': true,
        'field_class': 'col-12 col-sm-12',
        'label_class': 'form-label',
        'input_class': 'w-100',
        'is_horizontal': false,
        'align_label_right': false,
        'mb': 'mb-2'
    },
    'default': {
        'full_width': false,
        'field_class': 'col-12 col-sm-6',
        'label_class': 'col-xxl-5 text-xxl-end',
        'input_class': 'col-xxl-7',
        'is_horizontal': true,
        'align_label_right': true
    }
} %}

{% if in_itilobject %}
    {% set currentOptions = tagDropdownOptions.in_itilobject %}
{% elseif is_form is defined and is_form %}
    {% set currentOptions = tagDropdownOptions.is_form %}
{% else %}
    {% set currentOptions = tagDropdownOptions.default %}
{% endif %}

{% if is_form is defined and is_form == false and in_itilobject == false %}
    {% if is_dropdown is defined and is_dropdown %}
        <div class="card-body row">
    {% else %}
            {% set class = is_new_item ? 'col-xxl-12' : 'col-xxl-9' %}
        <div class="card-body d-flex flex-wrap">
            <input type="hidden" name='_plugin_tag_tag_process_form', id='_plugin_tag_tag_process_form', value='1' />
            <div class="col-12 {{ class }} flex-column">
                <div class="d-flex flex-row flex-wrap flex-xl-nowrap">
                    <div class="row flex-row align-items-start flex-grow-1" style="min-width: 0;">
                        <div class="row flex-row">
    {% endif %}
{% endif %}

{% include "@tag/dropdown.html.twig" with {
    'input_name'     : '_plugin_tag_tag_values',
    'selected_tags'  : selected_tags,
    'available_tags' : available_tags,
    'tags_color'     : tags_color,
    'rand'           : rand,
    'dropdown_params': {
        'id'               : 'tag_select_',
        'disabled'         : readOnly,
        'full_width'       : currentOptions.full_width,
        'field_class'      : currentOptions.field_class,
        'label_class'      : currentOptions.label_class,
        'input_class'      : currentOptions.input_class,
        'align_label_right': currentOptions.align_label_right,
        'is_horizontal'    : currentOptions.is_horizontal,
        'mb'               : currentOptions.mb|default(''),
    }
} %}

{% if is_form is defined and is_form == false and in_itilobject == false %}
    {% if is_dropdown is defined and is_dropdown %}
        </div>
    {% else %}
                        </div>
                    </div>
                </div>
            </div>
        </div>
    {% endif %}
{% endif %}
